{% extends 'base.html' %}

{% block title %}Aiemmat kyselyt {% endblock %}

{% block head %}
{% endblock %}

{% block content %}
</br>
  <h2><img src="{{ url_for('static', filename='images/list_white_36dp.svg') }}"width="42" height="47" class="d-inline-block align-text-top">  Aiemmat kyselyt</h2>

  <BR>
    <table id="surveys_table" cellspacing="10" class="table table-striped">
      <thead class="table-dark">
        <tr>
            <th scope="col"><p>Nimi</p></th>
            <th scope="col"><p>Kyselyn tila</p> </th>
            <th scope="col"><p>Ryhmät luotu</p></th>
            {% if is_teacher %}<th scope="col"><p>Toiminnot</p></th>{% endif %}
            <th scope="col"><p>Vastausaika päättyy</p></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          {% for row in active_surveys %}
          <td><a href="/surveys/{{ row[0] }}">{{ row[1] }}</a></td>       <!--survey name--> 
          <td><p>{% if row[2] %} Suljettu {% else %} Avoin {% endif %}</p></td>
          <td><p>{% if row[3] %} Kyllä {% else %} Ei {% endif %}</p></td>
          {% if is_teacher %}
          <td>
            <a href="/surveys/{{ row[0] }}/answers">Tarkastele tuloksia</a><br>
            <a href="#" onclick="copyURL('{{ row[0] }}')">Kopioi kyselyn osoite leikepöydälle</button><br>
            <a href="/surveys/{{ row[0] }}/edit">Muokkaa kyselyä tai lisää opettaja siihen</a><br>
            <a href="/surveys/create?fromTemplate={{ row[0] }}">Kopioi kysely</a><br>
            <a href="/surveys/{{ row[0] }}/delete" onclick="return confirm('Haluatko varmasti poistaa kyselyn?')">Poista kysely</a>
          </td>
          {% endif %}
          <td>{{ format_datestring(row[4]) }}</td>

        </tr>
        {% endfor %}
          <td>---</td>
          <td>---</td>
          <td>---</td>
          {% if is_teacher %}<td>---</td>{% endif %}
          <td>---</td>
          <tr>
            {% for row in closed_surveys %}
            <td><a href="/surveys/{{ row[0] }}">{{ row[1] }}</a></td>       <!--survey name--> 
            <td><p>{% if row[2] %} Suljettu {% else %} Avoin {% endif %}</p></td>
            <td><p>{% if row[3] %} Kyllä {% else %} Ei {% endif %}</p></td>
            {% if is_teacher %}
            <td>
              <a href="/surveys/{{ row[0] }}/answers">Tarkastele tuloksia</a><br>
              <a href="/surveys/{{ row[0] }}/edit">Muokkaa kyselyä</a><br>
              <a href="/surveys/create?fromTemplate={{ row[0] }}">Kopioi kysely</a>
            </td>
            {% endif %}
            <td>{{ row[4] }}</td>
  
          </tr>
          {% endfor %}
      </tbody>
    </table>

    <script>
      function copyURL(str) {
        var url = window.location.href
        if (url.includes("#")) {
          url = url.replace('#', '')
        }
        navigator.clipboard.writeText(url + "/" + str);
      }
    </script>
{% endblock %}
